<div class="container mx-auto px-4 py-6">
  <h2 class="text-2xl font-semibold mb-6 text-center">Mechanics List</h2>

  <!-- Error -->
  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
    {{ errorMessage }}
  </div>

  <!-- Add Button -->
  <div class="flex justify-end mb-4">
    <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded" (click)="openModal()">+ Add Mechanic</button>
  </div>

  <!-- Mechanics Table -->
  <div *ngIf="mechanics.length > 0; else noMechanics" class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow-md">
      <thead class="bg-gray-100 text-gray-700 uppercase text-sm leading-normal">
        <tr>
          <th class="py-3 px-6 text-left">ID</th>
          <th class="py-3 px-6 text-left">Name</th>
          <th class="py-3 px-6 text-left">Email</th>
          <th class="py-3 px-6 text-left">Phone</th>
          <th class="py-3 px-6 text-left">Role</th>
          <th class="py-3 px-6 text-left">Actions</th>
        </tr>
      </thead>
      <tbody class="text-gray-600 text-sm font-light">
        <tr *ngFor="let mechanic of mechanics" class="border-b border-gray-200 hover:bg-gray-50">
          <td class="py-3 px-6">{{ mechanic.id }}</td>
          <td class="py-3 px-6">{{ mechanic.name }}</td>
          <td class="py-3 px-6">{{ mechanic.email }}</td>
          <td class="py-3 px-6">{{ mechanic.phone }}</td>
          <td class="py-3 px-6 text-green-700">{{ mechanic.roleName }}</td>
          <td class="py-3 px-6">
            <button
            (click)="confirmDelete(mechanic)"
            class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded transition"
            >
               Delete
            </button>

          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty -->
  <ng-template #noMechanics>
    <p class="text-gray-500 text-center">No mechanics found.</p>
  </ng-template>

  <!-- Modal -->
<!-- Modal Overlay -->
<div *ngIf="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-4">
  <!-- Modal Box -->
  <div class="bg-white rounded-lg shadow-lg w-full max-w-lg relative sm:max-w-xl md:max-w-2xl">
    <!-- Close Button -->
    <button
      (click)="closeModal()"
      class="absolute top-3 right-4 text-gray-500 hover:text-black text-2xl focus:outline-none"
    >
      &times;
    </button>

    <!-- Modal Content -->
    <div class="p-6 sm:p-8">
      <h3 class="text-xl sm:text-2xl font-semibold mb-4 text-center">Add Mechanic</h3>

      <!-- Search Input -->
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="filterUsers()"
        placeholder="Search by email..."
        class="w-full p-2 sm:p-3 border border-gray-300 rounded mb-5 focus:outline-none focus:ring-2 focus:ring-blue-400"
      />

      <!-- User List -->
      <ul class="max-h-60 overflow-y-auto divide-y divide-gray-200">
        <li
          *ngFor="let user of filteredUsers"
          class="py-3 px-2 sm:px-4 md:flex justify-between items-center hover:bg-gray-50 transition"
        >
            <div>
              <p class="font-medium text-base sm:text-lg">{{ user.name }}</p>
              <p class="text-sm text-gray-500">{{ user.email }}</p>
            </div>
            <button
              class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 sm:px-4 sm:py-2 rounded text-sm sm:text-base transition"
              (click)="makeMechanic(user)"
            >
              Make Mechanic
            </button>
        </li>
      </ul>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div *ngIf="showDeleteModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-lg w-full max-w-md relative">
    <button (click)="closeDeleteModal()" class="absolute top-2 right-3 text-gray-500 hover:text-black text-xl">&times;</button>
    <h3 class="text-lg font-semibold mb-4 text-center">Confirm Deletion</h3>
    <p class="text-gray-700 mb-6 text-center">
      Are you sure you want to remove <span class="font-semibold">{{ mechanicToDelete?.name }}</span> as a mechanic?
    </p>
    <div class="flex justify-center gap-4">
      <button
        (click)="removeMechanicConfirmed()"
        class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"
      >
        Yes, Delete
      </button>
      <button
        (click)="closeDeleteModal()"
        class="bg-gray-300 hover:bg-gray-400 text-black px-4 py-2 rounded"
      >
        Cancel
      </button>
    </div>
  </div>
</div>
