<div class="p-6 max-w-6xl mx-auto space-y-8">

  <!-- Header -->
  <div class="flex justify-between items-center bg-gradient-to-r from-blue-50 to-blue-100 px-6 py-4 rounded-xl shadow">
    <h2 class="text-2xl font-bold text-gray-800">Service Slots</h2>
    <button
      (click)="openAddModal()"
      class="px-5 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 shadow-md active:scale-95 transition"
    >
      Add Slot
    </button>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="text-red-600 text-center text-base font-medium bg-red-50 border border-red-300 px-4 py-3 rounded shadow">
    {{ errorMessage }}
  </div>

  <!-- Slot Table -->
  <div class="bg-gradient-to-br from-white to-blue-50 rounded-xl shadow-lg p-4 overflow-x-auto">
    <table class="min-w-full text-sm text-left border-collapse">
      <thead class="bg-blue-100 text-gray-800">
        <tr>
          <th class="px-5 py-3 border-b">Date</th>
          <th class="px-5 py-3 border-b">Time</th>
          <th class="px-5 py-3 border-b">Mechanic</th>
          <th class="px-5 py-3 border-b">Status</th>
          <th class="px-5 py-3 border-b text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let slot of slots" class="hover:bg-blue-100 transition">
          <td class="px-5 py-3 border-b">{{ slot.slotDateTime | date: 'mediumDate' }}</td>
          <td class="px-5 py-3 border-b">{{ slot.slotDateTime | date: 'shortTime' }}</td>
          <td class="px-5 py-3 border-b">{{ slot.mechanicName }}</td>
          <td class="px-5 py-3 border-b capitalize">
            <span [ngClass]="{
              'text-green-600 font-semibold': slot.status === 'available',
              'text-blue-600 font-semibold': slot.status === 'booked',
              'text-green-800 font-bold': slot.status === 'completed',
              'text-red-500 font-medium': slot.status === 'cancelled'
            }">
              {{ slot.status }}
            </span>
          </td>
          <td class="px-5 py-3 border-b text-center">
            <button
              (click)="openEditModal(slot)"
              [disabled]="slot.status !== 'available'"
              class="px-4 py-1 text-white bg-yellow-500 rounded hover:bg-yellow-600 transition"
              [ngClass]="{
                'cursor-not-allowed opacity-50': slot.status !== 'available'
              }"
            >
              Edit
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal -->
  <div *ngIf="isModalOpen" class="fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl w-full max-w-md shadow-xl border border-gray-200">
      <!-- Modal Header -->
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-gray-800">
          {{ modalMode === 'edit' ? 'Edit Slot' : 'Add Slot' }}
        </h3>
        <button (click)="closeModal()" class="text-gray-500 hover:text-black text-2xl">&times;</button>
      </div>

      <!-- Form -->
      <form [formGroup]="slotForm" (ngSubmit)="saveSlot()" class="space-y-5">

        <!-- Date & Time Field -->
        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">Slot Date & Time</label>
          <input
            type="datetime-local"
            formControlName="slotDateTime"
            [attr.min]="currentDateTime"
            class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400"
          />
        </div>

        <!-- Mechanic Dropdown -->
        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">Mechanic</label>
          <select
            formControlName="mechanicID"
            class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400"
          >
            <option [ngValue]="null" disabled>Select mechanic</option>
            <option *ngFor="let mech of mechanics" [ngValue]="mech.id">
              {{ mech.name }}
            </option>
          </select>
        </div>

        <!-- Status Dropdown -->
        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">Status</label>
          <select
            formControlName="status"
            class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400"
          >
            <option value="available">Available</option>
            <option value="booked">Booked</option>
            <option value="completed">Completed</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-between mt-6">
          <!-- Left: Delete button -->
          <button
            *ngIf="modalMode === 'edit'"
            type="button"
            (click)="deleteSlot()"
            class="text-red-600 border border-red-500 px-4 py-2 rounded hover:bg-red-50 transition"
          >
            Delete
          </button>

          <!-- Right: Cancel and Save -->
          <div class="flex gap-3">
            <button
              type="button"
              (click)="closeModal()"
              class="border px-4 py-2 rounded hover:bg-gray-100"
            >
              Cancel
            </button>
            <button
              type="submit"
              [disabled]="slotForm.invalid"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
            >
              {{ modalMode === 'edit' ? 'Save' : 'Add' }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

</div>
